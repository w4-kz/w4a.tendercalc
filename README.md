# Tender Calc

Модуль для коробочного Битрикс24,
добавляет сущность для храния дополинтельных данных со сделки,
с выводом их систематизированно, в табличной части (грид).
видео работы модуля можно посмотреть тут: https://www.youtube.com/watch?v=tGXXUjEk6t4&list=PLan3DHIs0kRgDNPG4DG4pJT5o_QCvqOWd&index=4

### Особенности:
1. В отличии от пользовательских полей Сделки, данные имеют привязку не только к сделке, 
   но и товарной номенклатуре;
2. Данные выводятся в табличной части:
    1. на отдельной страницы приложения;
    2. в карточке сделки.
3. Имеется контентный поиск товара по наименованию, при вводе в поле "Наименование номенклатура"
4. Калькулятор автоматически рассчитывает стоимость по товарам. в зависимости от закупочной цены и наценки на товары.
### Установка

Клонируйте данный репозиторий в папку `/local/modules`

```
git clone https://github.com/w4-kz/w4a.tendercalc.git
```

После в админке на странице "Решения маркетплейс", 
доступной по адресу `/bitrix/admin/partner_modules.php` 
вы увидите данный модуль в списке модулей.

### Настройки

После установки необходимо:
1. пойти в конфиг модуля: 
   доступной по адресу `/bitrix/admin/perfmon_table.php?table_name=w4a_tendercalc_config` 
    и внести изменения в настройки:
    1. CATALOG_IBLOCK_ID (обязательно) - IBLOCK_ID Товарного каталога;
    2. TENDERCALC_BP_ID (опционально) - ID БП, который запускается п событию: "Отправить";
    3. TENDERCALC_COMPLETED_BP_ID (опционально) - ID БП, который запускается п событию: "Заполненность полей";
    4. TENDERCALC_PROFIT_RATIO_DEFAULT (опционально) - Наценка расчетная (по умолчанию);
    5. TENDERCALC_NDS - ставка НДС (%)
2. Создать Локальное приложение со следующими доступами:
    1. CRM;
    2. Пользователи;
    3. 
3. Прописать параметры локального приложения в настройки приложения,
   доступен по адресу: w4a_apps/widget/tendercalc/settings.php
   1. Application ID
   `define('C_REST_CLIENT_ID','local.XXX.XXX');`
   2. Application key
   `
   define('C_REST_CLIENT_SECRET','XXX');
   `
